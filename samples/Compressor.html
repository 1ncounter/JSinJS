<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<title>javascript code compressor</title>
<script src="../source/Parser.js"></script>
</head>
<body>
<textarea id="code" style="width:100%;height:500px;"></textarea>
<button >parse</button>
<div id="output"></div>
<script>
document.querySelector("button").onclick = function(){
    var parser = new Parser();
    var tree = parser.parse(document.querySelector("#code").value);

    var str = "";
    var last = null;

    function visit(tree) {
        if(tree.token) { 

            if(last) {
                if((tree.token.Identifier || tree.token.Keyword) && (last.Identifier || last.Keyword)) str += " ";
                if(tree.token.NumericLiteral && last.name == "." || last.name == "." && tree.token.NumericLiteral) str += " ";
            }
            last = tree.token;
            str += tree.token;
        }
        else {
            var i = tree.childNodes.length;
            while(i--)visit(tree.childNodes[i]);
        }
        
    }
    visit(tree);
    document.querySelector("#output").innerText = str;
    
}

</script>
</body>
</html>